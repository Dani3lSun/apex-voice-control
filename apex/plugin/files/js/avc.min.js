var avc={gAvcSocket:null,gAjaxIdentifier:null,gPlgFilePrefix:null,connectWebsocket:function(e,t,n,a){var o=$v("pInstance"),r="username="+n.toLowerCase()+"&serverKey="+t+"&userAccessToken="+a+"&apexSessionId="+o;apex.debug.log("avc.connectWebsocket - connectString",r),avc.gAvcSocket=io.connect(e+"/avc",{query:r})},handleWebsocket:function(e){var t="",n=$v("pInstance");avc.gAvcSocket.on("message",function(a){if(apex.debug.log("avc.handleWebsocket - message data",a),apex.event.trigger("body","avc-websocket-message"),"NAV_TO_PAGE"==a.type&&a.pageId)t="f?p="+$v("pFlowId")+":"+a.pageId+":"+n+":::::",avc.getProperUrl(t,e,function(e){apex.navigation.redirect(e)});else if("NAV_TO_PAGE_SEARCH"==a.type&&a.pageId)t="f?p="+$v("pFlowId")+":"+a.pageId+":"+n+":::"+a.searchParam+a.searchValue,avc.getProperUrl(t,e,function(e){apex.navigation.redirect(e)});else if("CURRENT_PAGE_SEARCH"==a.type&&a.pages){for(var o=a.pages,r=0;r<o.length;r++)if(o[r].pageId==parseInt($v("pFlowStepId"))){var i=o[r].searchField;$("#"+i).val(a.searchValue),$("#"+i).parents(".a-IRR-search").find(".a-IRR-button--search").click()}}else"PARTY_MODE"==a.type&&avc.partyMode()}),avc.gAvcSocket.on("disconnect",function(){apex.debug.log("avc.handleWebsocket - websocket disconnected"),apex.event.trigger("body","avc-websocket-disconnect")})},getProperUrl:function(e,t,n){"Y"==t?apex.server.plugin(avc.gAjaxIdentifier,{x01:e},{dataType:"json",success:function(t){apex.debug.log("avc.getProperUrl - AJAX success",t),n(t.success?t.url:e)},error:function(t,a){apex.debug.log("avc.getProperUrl - AJAX error",a),n(e)}}):n(e)},partyMode:function(){!function(){function e(){var e=document.createElement("link");e.setAttribute("type","text/css"),e.setAttribute("rel","stylesheet"),e.setAttribute("href",A),e.setAttribute("class",k),document.body.appendChild(e)}function t(){for(var e=document.getElementsByClassName(k),t=0;t<e.length;t++)document.body.removeChild(e[t])}function n(){var e=document.createElement("div");e.setAttribute("class",y),document.body.appendChild(e),setTimeout(function(){document.body.removeChild(e)},100)}function a(e){return{height:e.offsetHeight,width:e.offsetWidth}}function o(e){var t=a(e);return t.height>p&&t.height<v&&t.width>f&&t.width<h}function r(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function i(){var e=document.documentElement;return window.innerWidth?window.innerHeight:e&&!isNaN(e.clientHeight)?e.clientHeight:0}function c(){return window.pageYOffset?window.pageYOffset:Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function s(e){var t=r(e);return t>=I&&t<=P+I}function l(){var e=document.createElement("audio");e.setAttribute("class",k),e.src=m,e.loop=!1,e.innerHTML=" <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p>",document.body.appendChild(e),e.addEventListener("ended",function(){g(),t()},!0),e.addEventListener("canplay",function(){setTimeout(function(){d(_)},500),setTimeout(function(){g(),n();for(var e=0;e<C.length;e++)u(C[e])},15500)},!0),e.play()}function d(e){e.className+=" "+b+" "+x}function u(e){e.className+=" "+b+" "+w[Math.floor(Math.random()*w.length)]}function g(){for(var e=document.getElementsByClassName(b),t=new RegExp("\\b"+b+"\\b"),n=0;n<e.length;)e[n].className=e[n].className.replace(t,"")}for(var p=30,f=30,v=350,h=350,m=avc.gPlgFilePrefix+"misc/harlem-shake.mp3",b="mw-harlem_shake_me",x="im_first",w=["im_drunk","im_baked","im_trippin","im_blown"],y="mw-strobe_light",A=avc.gPlgFilePrefix+"css/harlem-shake-style.min.css",k="mw_added_css",P=i(),I=c(),E=document.getElementsByTagName("*"),_=null,H=0;H<E.length;H++){var T=E[H];if(o(T)&&s(T)){_=T;break}}if(null===_)return void apex.debug.log("Could not find a node of the right size. Please try a different page.");apex.debug.log("Found start element: ",T," with width "+a(T).width+", height "+a(T).height+", and a total Y offset of "+r(T)),e(),l();for(var C=[],H=0;H<E.length;H++){var T=E[H];o(T)&&C.push(T)}}()},pluginHandler:function(){var e=this,t=avc.gAjaxIdentifier=e.action.ajaxIdentifier,n=e.action.attribute01,a=e.action.attribute02,o=e.action.attribute03,r=e.action.attribute04,i=e.action.attribute05,c=avc.gPlgFilePrefix=e.action.attribute06;apex.debug.log("avc.pluginHandler - ajaxIdentifier",t),apex.debug.log("avc.pluginHandler - baseUrl",n),apex.debug.log("avc.pluginHandler - serverKey",a),apex.debug.log("avc.pluginHandler - username",o),apex.debug.log("avc.pluginHandler - userAccessToken",r),apex.debug.log("avc.pluginHandler - allowSSPUrl",i),apex.debug.log("avc.pluginHandler - plgFilePrefix",c),avc.connectWebsocket(n,a,o,r),avc.handleWebsocket(i)}};