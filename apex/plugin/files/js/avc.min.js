var avc={gAvcSocket:null,gAjaxIdentifier:null,gPlgFilePrefix:null,gSpinner:null,connectWebsocket:function(e,t,n,a){var o=$v("pInstance"),r="username="+n.toLowerCase()+"&serverKey="+t+"&userAccessToken="+a+"&apexSessionId="+o;apex.debug.log("avc.connectWebsocket - connectString",r),avc.gAvcSocket=io.connect(e+"/avc",{query:r})},handleWebsocket:function(e,t){var n="",a=$v("pInstance");avc.gAvcSocket.on("message",function(o){if(apex.debug.log("avc.handleWebsocket - message data",o),apex.event.trigger("body","avc-websocket-message",o),"NAV_TO_PAGE"==o.type&&o.pageId)apex.event.trigger("body","avc-websocket-message-nav_to_page",o),"Y"==t&&(avc.gSpinner=apex.util.showSpinner($("body")),n="f?p="+$v("pFlowId")+":"+o.pageId+":"+a+":::::",avc.getProperUrl(n,e,function(e){apex.navigation.redirect(e)}));else if("NAV_TO_PAGE_SEARCH"==o.type&&o.pageId)apex.event.trigger("body","avc-websocket-message-nav_to_page_search",o),"Y"==t&&(avc.gSpinner=apex.util.showSpinner($("body")),n="f?p="+$v("pFlowId")+":"+o.pageId+":"+a+":::"+o.searchParam+o.searchValue,avc.getProperUrl(n,e,function(e){apex.navigation.redirect(e)}));else if("CURRENT_PAGE_SEARCH"==o.type&&o.pages){if(apex.event.trigger("body","avc-websocket-message-current_page_search",o),"Y"==t)for(var r=o.pages,i=0;i<r.length;i++)if(r[i].pageId==parseInt($v("pFlowStepId"))){var c=r[i].searchField;$("#"+c).val(o.searchValue),$("#"+c).hasClass("a-IRR-search-field")&&$("#"+c).parents(".a-IRR-search").find(".a-IRR-button--search").click()}}else"PARTY_MODE"==o.type&&(apex.event.trigger("body","avc-websocket-message-party_mode",o),"Y"==t&&avc.partyMode())}),avc.gAvcSocket.on("disconnect",function(){apex.debug.log("avc.handleWebsocket - websocket disconnected"),apex.event.trigger("body","avc-websocket-disconnect")})},getProperUrl:function(e,t,n){"Y"==t?apex.server.plugin(avc.gAjaxIdentifier,{x01:e},{dataType:"json",success:function(t){apex.debug.log("avc.getProperUrl - AJAX success",t),n(t.success?t.url:e)},error:function(t,a){apex.debug.log("avc.getProperUrl - AJAX error",a),n(e)}}):n(e)},partyMode:function(){!function(){function e(){var e=document.createElement("link");e.setAttribute("type","text/css"),e.setAttribute("rel","stylesheet"),e.setAttribute("href",k),e.setAttribute("class",A),document.body.appendChild(e)}function t(){for(var e=document.getElementsByClassName(A),t=0;t<e.length;t++)document.body.removeChild(e[t])}function n(){var e=document.createElement("div");e.setAttribute("class",w),document.body.appendChild(e),setTimeout(function(){document.body.removeChild(e)},100)}function a(e){return{height:e.offsetHeight,width:e.offsetWidth}}function o(e){var t=a(e);return t.height>p&&t.height<f&&t.width>v&&t.width<h}function r(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function i(){var e=document.documentElement;return window.innerWidth?window.innerHeight:e&&!isNaN(e.clientHeight)?e.clientHeight:0}function c(){return window.pageYOffset?window.pageYOffset:Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function s(e){var t=r(e);return t>=P&&t<=_+P}function l(){var e=document.createElement("audio");e.setAttribute("class",A),e.src=m,e.loop=!1,e.innerHTML=" <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p>",document.body.appendChild(e),e.addEventListener("ended",function(){g(),t()},!0),e.addEventListener("canplay",function(){setTimeout(function(){d(E)},500),setTimeout(function(){g(),n();for(var e=0;e<T.length;e++)u(T[e])},15500)},!0),e.play()}function d(e){e.className+=" "+b+" "+x}function u(e){e.className+=" "+b+" "+y[Math.floor(Math.random()*y.length)]}function g(){for(var e=document.getElementsByClassName(b),t=new RegExp("\\b"+b+"\\b"),n=0;n<e.length;)e[n].className=e[n].className.replace(t,"")}for(var p=30,v=30,f=350,h=350,m=avc.gPlgFilePrefix+"misc/harlem-shake.mp3",b="mw-harlem_shake_me",x="im_first",y=["im_drunk","im_baked","im_trippin","im_blown"],w="mw-strobe_light",k=avc.gPlgFilePrefix+"css/harlem-shake-style.min.css",A="mw_added_css",_=i(),P=c(),I=document.getElementsByTagName("*"),E=null,S=0;S<I.length;S++){var H=I[S];if(o(H)&&s(H)){E=H;break}}if(null===E)return void apex.debug.log("Could not find a node of the right size. Please try a different page.");apex.debug.log("Found start element: ",H," with width "+a(H).width+", height "+a(H).height+", and a total Y offset of "+r(H)),e(),l();for(var T=[],S=0;S<I.length;S++){var H=I[S];o(H)&&T.push(H)}}()},pluginHandler:function(){var e=this,t=avc.gAjaxIdentifier=e.action.ajaxIdentifier,n=e.action.attribute01,a=e.action.attribute02,o=e.action.attribute03,r=e.action.attribute04,i=e.action.attribute05,c=e.action.attribute06,s=avc.gPlgFilePrefix=e.action.attribute07;apex.debug.log("avc.pluginHandler - ajaxIdentifier",t),apex.debug.log("avc.pluginHandler - baseUrl",n),apex.debug.log("avc.pluginHandler - serverKey",a),apex.debug.log("avc.pluginHandler - username",o),apex.debug.log("avc.pluginHandler - userAccessToken",r),apex.debug.log("avc.pluginHandler - enableDefaultActions",i),apex.debug.log("avc.pluginHandler - allowSSPUrl",c),apex.debug.log("avc.pluginHandler - plgFilePrefix",s),avc.gSpinner&&avc.gSpinner.remove(),avc.connectWebsocket(n,a,o,r),avc.handleWebsocket(c,i)}};