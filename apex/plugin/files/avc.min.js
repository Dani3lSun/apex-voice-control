var avc={gAvcSocket:null,gAjaxIdentifier:null,connectWebsocket:function(e,t,n,a){var o=$v("pInstance"),r="username="+n.toLowerCase()+"&serverKey="+t+"&userAccessToken="+a+"&apexSessionId="+o;apex.debug.log("avc.connectWebsocket - connectString",r),avc.gAvcSocket=io.connect(e+"/avc",{query:r})},handleWebsocket:function(e){var t="",n=$v("pInstance");avc.gAvcSocket.on("message",function(a){if(apex.debug.log("avc.handleWebsocket - message data",a),apex.event.trigger("body","avc-websocket-message"),"NAV_TO_PAGE"==a.type&&a.pageId)t="f?p="+$v("pFlowId")+":"+a.pageId+":"+n+":::::",avc.getProperUrl(t,e,function(e){apex.navigation.redirect(e)});else if("NAV_TO_PAGE_SEARCH"==a.type&&a.pageId)t="f?p="+$v("pFlowId")+":"+a.pageId+":"+n+":::"+a.searchParam+a.searchValue,avc.getProperUrl(t,e,function(e){apex.navigation.redirect(e)});else if("CURRENT_PAGE_SEARCH"==a.type&&a.pages){for(var o=a.pages,r=0;r<o.length;r++)if(o[r].pageId==parseInt($v("pFlowStepId"))){var c=o[r].searchField;$("#"+c).val(a.searchValue),$("#"+c).parents(".a-IRR-search").find(".a-IRR-button--search").click()}}else"PARTY_MODE"==a.type&&avc.partyMode()}),avc.gAvcSocket.on("disconnect",function(){apex.debug.log("avc.handleWebsocket - websocket disconnected"),apex.event.trigger("body","avc-websocket-disconnect")})},getProperUrl:function(e,t,n){"Y"==t?apex.server.plugin(avc.gAjaxIdentifier,{x01:e},{dataType:"json",success:function(t){apex.debug.log("avc.getProperUrl - AJAX success",t),n(t.success?t.url:e)},error:function(t,a){apex.debug.log("avc.getProperUrl - AJAX error",a),n(e)}}):n(e)},partyMode:function(){!function(){function e(){var e=document.createElement("link");e.setAttribute("type","text/css"),e.setAttribute("rel","stylesheet"),e.setAttribute("href",k),e.setAttribute("class",x),document.body.appendChild(e)}function t(){for(var e=document.getElementsByClassName(x),t=0;t<e.length;t++)document.body.removeChild(e[t])}function n(){var e=document.createElement("div");e.setAttribute("class",A),document.body.appendChild(e),setTimeout(function(){document.body.removeChild(e)},100)}function a(e){return{height:e.offsetHeight,width:e.offsetWidth}}function o(e){var t=a(e);return t.height>p&&t.height<v&&t.width>f&&t.width<m}function r(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function c(){var e=document.documentElement;return window.innerWidth?window.innerHeight:e&&!isNaN(e.clientHeight)?e.clientHeight:0}function i(){return window.pageYOffset?window.pageYOffset:Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function s(e){var t=r(e);return t>=E&&t<=I+E}function d(){var e=document.createElement("audio");e.setAttribute("class",x),e.src=h,e.loop=!1,e.innerHTML=" <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p>",document.body.appendChild(e),e.addEventListener("ended",function(){g(),t()},!0),e.addEventListener("canplay",function(){setTimeout(function(){l(T)},500),setTimeout(function(){g(),n();for(var e=0;e<C.length;e++)u(C[e])},15500)},!0),e.play()}function l(e){e.className+=" "+b+" "+w}function u(e){e.className+=" "+b+" "+y[Math.floor(Math.random()*y.length)]}function g(){for(var e=document.getElementsByClassName(b),t=new RegExp("\\b"+b+"\\b"),n=0;n<e.length;)e[n].className=e[n].className.replace(t,"")}for(var p=30,f=30,v=350,m=350,h="//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3",b="mw-harlem_shake_me",w="im_first",y=["im_drunk","im_baked","im_trippin","im_blown"],A="mw-strobe_light",k="//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css",x="mw_added_css",I=c(),E=i(),_=document.getElementsByTagName("*"),T=null,H=0;H<_.length;H++){var P=_[H];if(o(P)&&s(P)){T=P;break}}if(null===T)return void console.warn("Could not find a node of the right size. Please try a different page.");console.log("Found start element: ",P," with width "+a(P).width+", height "+a(P).height+", and a total Y offset of "+r(P)),e(),d();for(var C=[],H=0;H<_.length;H++){var P=_[H];o(P)&&C.push(P)}}()},pluginHandler:function(){var e=this,t=avc.gAjaxIdentifier=e.action.ajaxIdentifier,n=e.action.attribute01,a=e.action.attribute02,o=e.action.attribute03,r=e.action.attribute04,c=e.action.attribute05;apex.debug.log("avc.pluginHandler - ajaxIdentifier",t),apex.debug.log("avc.pluginHandler - baseUrl",n),apex.debug.log("avc.pluginHandler - serverKey",a),apex.debug.log("avc.pluginHandler - username",o),apex.debug.log("avc.pluginHandler - userAccessToken",r),apex.debug.log("avc.pluginHandler - allowSSPUrl",c),avc.connectWebsocket(n,a,o,r),avc.handleWebsocket(c)}};